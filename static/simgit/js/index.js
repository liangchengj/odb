var webSocketClick={ws:null,app_block:null,githubUrl:null,init:function(){var t=this;t.app_block=$(".app-block");t.ws=new WebSocket("ws://gg.widyun.com/wss"),t.ws.onopen=function(e){t.onOpen(e)},t.ws.onmessage=function(e){t.onMessage(e)},t.ws.onclose=function(e){t.onClose(e)},t.app_block.find(".sub-btn").on("click",function(){t.getSource($(this))}),$(".exemption").on("click",function(){return layer.alert('<div style="font-size:1rem;margin:15px;">            <span style="font-size:1.5rem;">Browsing and using the download service on this site is deemed to be an endorsement of the content of the following statement</span>            <p>1, this site does not store resources, only transit platform</p>            <p>2. Use this site to download any resources at your own risk</p>            <p>3. This site only substitutes existing codes on the Internet, and cannot make any promises and guarantees on the availability, accuracy or reliability of these codes</p>            <p>4. This site is not responsible for any direct and indirect losses caused by the use or inability to use the code provided by this site</p>            <p>5. No unit or individual may use this site to download any software or materials that are infringing, pirated or illegal</p>            </div>',{title:"Disclaimer",area:"500px"}),!1})},onOpen:function(t){sendJson={type:"2"},this.ws.send(JSON.stringify(sendJson)+"\n"),console.log("connection succeeded")},onMessage:function(t){var e=this;try{var n=JSON.parse(t.data);if(1==n.status)return layer.msg(n.msg),setTimeout(function(){window.location.reload()},3e3),!1;switch(n.data.sta){case 1:case 2:(n.msg="正在检出代码")&&(n.msg="Checking out code"),(n.msg="正在打包，请稍后")&&(n.msg="Packaging, please wait. . .");break;case 3:(n.msg="下载压缩包")&&(n.msg="Dwonload zip"),null!=n.data.url&&""!=n.data.url&&(n.data.url="http://gg.widyun.com"+n.data.url),layer.msg("The operation is complete, please download"),e.app_block.find(".sub-btn").html('<a class="download-btn" href="javascript:void(0);" onclick="window.location.href=\''+n.data.url+'\';" target="_blank">'+n.msg+"</a>").css({background:"green",color:"#fff"}),$(".download-btn").on("click",function(){sendJson={type:"1"},e.ws.send(JSON.stringify(sendJson)+"\n"),sendJson.type="2",e.ws.send(JSON.stringify(sendJson)+"\n"),setTimeout(function(){window.location.reload()},2e3)});break;case 4:$(".down_num").find("b").text($.trim(n.data.down_num))}}catch(t){}},onClose:function(t){console.log("Connection closed")},getSource:function(t){var e=this.app_block.find(".text"),n=new RegExp("^https:\\/\\/github.com\\/([\\w\\/\\d\\-\\_\\.]+)$","ig"),o=new RegExp("^((https|http):\\/\\/)?([\\w\\.\\/\\-\\_^]+?)\\.([tar\\.gz|tgz|msi|gz|tar\\.bz2|bz2|tar|zip|tar\\.xz|tar\\.z|rpm|deb|apk|exe|7z|dmg|rar|jar]+?)$","ig");if(!e.val())return layer.msg("Please enter github address"),e.select(),!1;var s=$.trim(e.val());if(!n.test(s)&&!o.test(s))return layer.msg("Please enter the correct github address: only supports https protocol or <br> (gz|tar.gz|bz2|tar|tar.bz2|zip|tar.xz|tar.z|rpm|deb|rar) format compressed package Download link"),e.select(),!1;this.githubUrl=s,this.getSourceInit()},getSourceInit:function(){var t={url:this.githubUrl};this.app_block.find(".sub-btn").prop("disabled",!0).off("click").css({background:"none",color:"#EACB20"}),this.ws.send(JSON.stringify(t)+"\n")}};$(function(){webSocketClick.init(),$("#ah").html(""),$("#cp").html(""),$("body h1").css({"margin-top":"2rem"})});